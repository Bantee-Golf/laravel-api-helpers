<?php

namespace {{ namespace }};

use Illuminate\Foundation\Testing\RefreshDatabase;
use Illuminate\Foundation\Testing\WithFaker;
use Tests\TestCase;

class {{ class }} extends TestCase
{

	use \EMedia\Api\Domain\Traits\NamesAndPathLocations;

	protected $responseStoragePath;
    protected $saveResponses = false;

    protected function setUp(): void
    {
        parent::setUp();

        if (env('API_SAVE_TEST_RESPONSES', false)) {
            $this->responseStoragePath = self::getApiResponsesAutoGenDir(true);
            $this->saveResponses = true;
        }
    }

    protected function saveResponse($data, $name, $status = '200', $extension = 'json')
    {
        if (!$this->saveResponses) return false;

        $filePath = $this->responseStoragePath . DIRECTORY_SEPARATOR . "{$name}_{$status}.{$extension}";
        $json = json_encode(json_decode($data, true), JSON_PRETTY_PRINT);
        file_put_contents($filePath, $json);
    }

	protected function getApiKey()
	{
		$key = env('API_KEY', false);

		if (!$key) throw new \Exception("You don't have an active API_KEY on `.env` file.");

		return $key;
	}

	protected function getAccessToken()
	{
		// TODO: add token
		return '';
	}

}
